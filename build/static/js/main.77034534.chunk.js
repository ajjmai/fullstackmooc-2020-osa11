(this["webpackJsonpbloglist-frontend"]=this["webpackJsonpbloglist-frontend"]||[]).push([[0],{70:function(e,t,n){},74:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n.n(r),a=n(23),i=n.n(a),o=n(6),s=n(15),u=n(22),l=n(39),d=n(40),j={content:null,className:null,timer:null},b=function(e,t){return function(n){var r=setTimeout((function(){n(f())}),5e3);n({type:"SET_NOTIFICATION",data:{content:e,className:t,timer:r}})}},f=function(){return{type:"CLEAR_NOTIFICATION"}},p=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:j,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_NOTIFICATION":return e.timer&&clearTimeout(e.timer),{content:t.data.content,className:t.data.className,timer:t.data.timer};case"CLEAR_NOTIFICATION":return j;default:return e}},O=n(2),h=n.n(O),m=n(4),g=n(18),x=n(44),v=n(16),y=n.n(v),w="/api/blogs",k=null,T={getAll:function(){var e=Object(m.a)(h.a.mark((function e(){var t;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.a.get(w);case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),create:function(){var e=Object(m.a)(h.a.mark((function e(t){var n,r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:k}},e.next=3,y.a.post(w,t,n);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),update:function(){var e=Object(m.a)(h.a.mark((function e(t){var n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.a.put("".concat(w,"/").concat(t.id),t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),remove:function(){var e=Object(m.a)(h.a.mark((function e(t){var n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:k}},e.next=3,y.a.delete("".concat(w,"/").concat(t),n);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),setToken:function(e){k="bearer ".concat(e)},addComment:function(){var e=Object(m.a)(h.a.mark((function e(t,n){var r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.a.post("".concat(w,"/").concat(t,"/comments"),{comment:n});case 2:return r=e.sent,e.abrupt("return",r.data);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()};function I(e,t){return t.likes-e.likes}var S,E,C,N,B,L,A,_,U,R,M,W,F,G=function(e){return function(){var t=Object(m.a)(h.a.mark((function t(n){var r;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,T.create(e);case 2:r=t.sent,n({type:"NEW_BLOG",data:r});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},D=function(e,t){return function(){var n=Object(m.a)(h.a.mark((function n(r){var c;return h.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,T.update(Object(g.a)(Object(g.a)({},e),{},{user:t}));case 2:c=n.sent,r({type:"LIKE_BLOG",data:c});case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()},z=function(e){return function(){var t=Object(m.a)(h.a.mark((function t(n){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,T.remove(e);case 2:n({type:"DELETE_BLOG",data:e});case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},J=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_BLOGS":return t.data.sort(I);case"NEW_BLOG":return[].concat(Object(x.a)(e),[t.data]).sort(I);case"LIKE_BLOG":return e.map((function(e){return e.id!==t.data.id?e:t.data})).sort(I);case"DELETE_BLOG":return e.filter((function(e){return e.id!==t.data}));case"NEW_COMMENT":var n=e.find((function(e){return e.id===t.data.id})),r=Object(g.a)(Object(g.a)({},n),{},{comments:n.comments.concat(t.data.comment)});return e.map((function(e){return e.id!==t.data.id?e:r}));default:return e}},H={login:function(){var e=Object(m.a)(h.a.mark((function e(t){var n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},K=function(e){window.localStorage.setItem("loggedBloglistUser",JSON.stringify(e)),T.setToken(e.token)},V=function(e){return function(){var t=Object(m.a)(h.a.mark((function t(n){var r;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,H.login(e);case 3:r=t.sent,n({type:"SET_USER",data:r}),K(r),n(b("Hello ".concat(r.name,"! You have succesfully logged in."),"notification")),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),n(b("Wrong username or password.","error"));case 12:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e){return t.apply(this,arguments)}}()},P=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_USER":return t.data;case"LOGOUT":return null;default:return e}},Y={getAll:function(){return y.a.get("/api/users").then((function(e){return e.data}))}},q=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_USERS":return t.data;default:return e}},Q=Object(u.combineReducers)({notification:p,blogs:J,login:P,users:q}),X=Object(u.createStore)(Q,Object(d.composeWithDevTools)(Object(u.applyMiddleware)(l.a))),Z=(n(70),n(5)),$=n(8),ee=n(9),te=ee.a.button(S||(S=Object($.a)(["\n  font-size: 1em;\n  margin: 1em 0;\n  padding: 0.25em 1em;\n  border: 2px solid MidnightBlue;\n  border-radius: 3px;\n  color: White;\n  background: MidnightBlue;\n"]))),ne=Object(ee.a)(te)(E||(E=Object($.a)(["\n  background: LightSteelBlue;\n  color: MidnightBlue;\n"]))),re=ee.a.div(C||(C=Object($.a)(["\n  background: MidnightBlue;\n  padding: 1em;\n  margin-top: 5em;\n  color: White;\n"]))),ce=Object(ee.a)(te)(N||(N=Object($.a)(["\n  margin: 1em;\n"]))),ae=ee.a.input(B||(B=Object($.a)(["\n  margin: 0.25em 0.25em 0.25em 1em;\n  padding: 0.5em 0.25em;\n  border-radius: 3px;\n  border-style: hidden;\n\n  &: focus {\n    outline: none;\n  }\n"]))),ie=ee.a.div(L||(L=Object($.a)(["\n  background: MidnightBlue;\n  padding: 1em;\n  color: White;\n"]))),oe=ee.a.div(A||(A=Object($.a)(["\n  &&& {\n    color: White;\n    font-size: 1.25em;\n    padding: 5px;\n    display: inline;\n\n    a {\n      text-decoration: none;\n      color: White;\n      font-weight: bold;\n    }\n  }\n"]))),se=ee.a.p(_||(_=Object($.a)(["\n  margin-left: 5em;\n  margin-right: 0.5em;\n  display: inline;\n"]))),ue=ee.a.div(U||(U=Object($.a)(["\n  font-size: 20px;\n  border-style: solid;\n  border-radius: 5px;\n  padding: 10px;\n  margin-bottom: 10px;\n"]))),le=ee.a.div(R||(R=Object($.a)(["\n  font-family: Helvetica Neue, sans-serif;\n\n  a {\n    text-decoration: none;\n    color: MidnightBlue;\n  }\n"]))),de=ee.a.h1(M||(M=Object($.a)(["\n  font-family: Tahoma, sans-serif;\n  font-size: 3em;\n"]))),je=Object(ee.a)(de)(W||(W=Object($.a)(["\n  font-size: 2em;\n"]))),be=Object(ee.a)(de)(F||(F=Object($.a)(["\n  font-size: 1em;\n  padding-top: 0.75em;\n  margin-bottom: 0.25em;\n"]))),fe=n(1),pe=function(){var e=Object(o.c)((function(e){return e.notification}));return e.content&&Object(fe.jsx)(ue,{className:e.className,children:e.content})},Oe=n(14),he=function(e){var t=e.handleLogin,n=Object(r.useState)(""),c=Object(Oe.a)(n,2),a=c[0],i=c[1],o=Object(r.useState)(""),s=Object(Oe.a)(o,2),u=s[0],l=s[1];return Object(fe.jsxs)(fe.Fragment,{children:[Object(fe.jsx)(je,{children:"Log in to application"}),Object(fe.jsxs)("form",{onSubmit:function(e){e.preventDefault(),t({username:a,password:u}),i(""),l("")},children:[Object(fe.jsxs)("div",{children:["username",Object(fe.jsx)(ae,{type:"text",value:a,name:"Username",onChange:function(e){var t=e.target;i(t.value)}})]}),Object(fe.jsxs)("div",{children:["password",Object(fe.jsx)(ae,{type:"password",value:u,name:"Password",onChange:function(e){var t=e.target;l(t.value)}})]}),Object(fe.jsx)(te,{id:"login-button",type:"submit",children:"login"})]})]})},me=function(){var e=Object(o.c)((function(e){return e.users})),t={textAlign:"center",verticalAlign:"middle"};return Object(fe.jsxs)("div",{children:[Object(fe.jsx)(je,{children:"Users"}),Object(fe.jsxs)("table",{children:[Object(fe.jsx)("thead",{children:Object(fe.jsxs)("tr",{children:[Object(fe.jsx)("td",{}),Object(fe.jsx)("td",{children:Object(fe.jsx)(be,{children:"blogs created"})})]})}),Object(fe.jsx)("tbody",{children:e.map((function(e){return Object(fe.jsxs)("tr",{children:[Object(fe.jsx)("td",{children:Object(fe.jsx)(s.b,{to:"/users/".concat(e.id),children:e.name})}),Object(fe.jsx)("td",{style:t,children:e.blogs.length})]},e.id)}))})]})]})},ge=function(e){var t=e.user;return t?Object(fe.jsxs)("div",{children:[Object(fe.jsx)(je,{children:t.name}),Object(fe.jsx)(be,{children:"added blogs"}),Object(fe.jsx)("ul",{children:t.blogs.map((function(e){return Object(fe.jsx)("li",{children:e.title},e.id)}))})]}):null},xe=function(e){var t=e.createBlog,n=Object(r.useState)(""),c=Object(Oe.a)(n,2),a=c[0],i=c[1],o=Object(r.useState)(""),s=Object(Oe.a)(o,2),u=s[0],l=s[1],d=Object(r.useState)(""),j=Object(Oe.a)(d,2),b=j[0],f=j[1];return Object(fe.jsxs)(fe.Fragment,{children:[Object(fe.jsx)(je,{children:"Add new blog"}),Object(fe.jsxs)("form",{onSubmit:function(e){e.preventDefault(),t({title:a,author:u,url:b}),i(""),l(""),f("")},children:[Object(fe.jsxs)("div",{children:["title:",Object(fe.jsx)(ae,{type:"text",value:a,name:"Title",id:"title",onChange:function(e){var t=e.target;i(t.value)}})]}),Object(fe.jsxs)("div",{children:["author:",Object(fe.jsx)(ae,{type:"text",value:u,name:"Author",id:"author",onChange:function(e){var t=e.target;l(t.value)}})]}),Object(fe.jsxs)("div",{children:["url:",Object(fe.jsx)(ae,{type:"text",value:b,name:"Url",id:"url",onChange:function(e){var t=e.target;f(t.value)}})]}),Object(fe.jsx)(te,{type:"submit",children:"Add"})]})]})},ve=c.a.forwardRef((function(e,t){var n=Object(r.useState)(!1),c=Object(Oe.a)(n,2),a=c[0],i=c[1],o={display:a?"none":""},s={display:a?"":"none"},u=function(){i(!a)};return Object(r.useImperativeHandle)(t,(function(){return{toggleVisibility:u}})),Object(fe.jsxs)("div",{children:[Object(fe.jsx)("div",{style:o,children:Object(fe.jsx)(te,{onClick:u,children:e.buttonLabel})}),Object(fe.jsxs)("div",{style:s,children:[e.children,Object(fe.jsx)(te,{onClick:u,children:"Cancel"})]})]})}));ve.displayName="Togglable";var ye=ve,we=function(){var e=Object(o.c)((function(e){return e.blogs})),t=Object(o.b)(),n=Object(r.useRef)(),c={paddingTop:10,paddingLeft:2,border:"solid",borderWidth:1,marginBottom:5},a=function(){var e=Object(m.a)(h.a.mark((function e(r){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{n.current.toggleVisibility(),t(G(r)),t(b("A new blog ".concat(r.title," by ").concat(r.author," added!"),"notification"))}catch(c){t(b("Adding blog failed.","error"))}case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(fe.jsxs)(fe.Fragment,{children:[Object(fe.jsx)(ye,{buttonLabel:"Add new blog",ref:n,children:Object(fe.jsx)(xe,{createBlog:a})}),Object(fe.jsx)(je,{children:"Blogs"}),e.map((function(e){return Object(fe.jsx)("p",{style:c,children:Object(fe.jsx)(s.b,{to:"/blogs/".concat(e.id),children:e.title})},e.id)}))]})},ke=function(e){var t=e.addComment,n=e.blogId,c=Object(r.useState)(""),a=Object(Oe.a)(c,2),i=a[0],o=a[1];return Object(fe.jsx)("form",{onSubmit:function(e){e.preventDefault(),t(n,i),o("")},children:Object(fe.jsxs)("div",{children:[Object(fe.jsx)(ae,{type:"text",value:i,name:"Comment",id:"comment",onChange:function(e){var t=e.target;o(t.value)}}),Object(fe.jsx)(ce,{type:"submit",children:"add comment"})]})})},Te=function(e){var t=e.blog,n=e.likeBlog,c=e.loggedInUserId,a=e.removeBlog,i=e.addComment;if(!t)return null;var o=t.user.id?c===t.user.id:c===t.user,s=Object(r.useMemo)((function(){return t.user.name}),[]);return Object(fe.jsxs)(fe.Fragment,{children:[Object(fe.jsxs)(je,{children:[t.title," by ",t.author]}),Object(fe.jsx)("a",{href:t.url,children:t.url}),Object(fe.jsxs)("p",{children:["likes ",t.likes," ",Object(fe.jsx)(ce,{onClick:function(e){e.preventDefault(),n(Object(g.a)(Object(g.a)({},t),{},{likes:t.likes+1}))},children:"like"})]}),Object(fe.jsxs)("p",{children:["added by ",s]}),o&&Object(fe.jsx)(te,{onClick:function(e){e.preventDefault(),a(t)},children:"remove"}),Object(fe.jsx)(be,{children:"comments"}),Object(fe.jsx)(ke,{addComment:i,blogId:t.id}),Object(fe.jsx)("ul",{children:t.comments.map((function(e,t){return Object(fe.jsx)("li",{children:e},t)}))})]})},Ie=function(){var e=Object(o.b)(),t=Object(o.c)((function(e){return e.login})),n=Object(Z.f)();return Object(fe.jsxs)(fe.Fragment,{children:[Object(fe.jsxs)(se,{children:[t.name," is logged in"]}),Object(fe.jsx)(ne,{onClick:function(t){t.preventDefault(),e((window.localStorage.clear(),{type:"LOGOUT"})),e(b("Logging out completed.","notification")),n.push("/")},children:"logout"})]})},Se=function(){var e=Object(o.b)(),t=Object(o.c)((function(e){return e.login})),n=Object(o.c)((function(e){return e.users})),c=Object(o.c)((function(e){return e.blogs})),a=Object(Z.g)("/users/:id"),i=Object(Z.g)("/blogs/:id");Object(r.useEffect)((function(){e(function(){var e=Object(m.a)(h.a.mark((function e(t){var n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T.getAll();case 2:n=e.sent,t({type:"INIT_BLOGS",data:n});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[e]),Object(r.useEffect)((function(){e(function(){var e=Object(m.a)(h.a.mark((function e(t){var n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Y.getAll();case 2:n=e.sent,t({type:"INIT_USERS",data:n});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[e]),Object(r.useEffect)((function(){e(function(){var e=Object(m.a)(h.a.mark((function e(t){var n,r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(n=window.localStorage.getItem("loggedBloglistUser"))&&(r=JSON.parse(n),T.setToken(r.token),t({type:"SET_USER",data:r}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[e]);var u=function(){var t=Object(m.a)(h.a.mark((function t(n){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e(V(n));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),l=function(){var t=Object(m.a)(h.a.mark((function t(n){var r;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=n.user.id?n.user.id:n.user;try{e(D(n,r))}catch(c){e(b("Updating blog failed.","error"))}case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),d=function(){var t=Object(m.a)(h.a.mark((function t(n){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(window.confirm("Remove blog ".concat(n.title," by ").concat(n.author,"?")))try{e(z(n.id)),e(b("Removed ".concat(n.title," by ").concat(n.author,"."),"notification"))}catch(r){e(b("Removing ".concat(n.title," by ").concat(n.author," failed."),"error"))}case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),j=a?n.find((function(e){return e.id===a.params.id})):null,f=i?c.find((function(e){return e.id===i.params.id})):null;return Object(fe.jsxs)(le,{children:[Object(fe.jsxs)(fe.Fragment,{children:[t&&Object(fe.jsxs)(ie,{children:[Object(fe.jsx)(oe,{children:Object(fe.jsx)(s.b,{to:"/",children:"blogs"})}),Object(fe.jsx)(oe,{children:Object(fe.jsx)(s.b,{to:"/users",children:"users"})}),Object(fe.jsx)(Ie,{})]}),Object(fe.jsx)(de,{children:"Bloglist"}),Object(fe.jsx)(pe,{}),!t&&Object(fe.jsx)(he,{handleLogin:u})]}),Object(fe.jsxs)(Z.c,{children:[Object(fe.jsx)(Z.a,{path:"/users/:id",children:t&&Object(fe.jsx)(ge,{user:j})}),Object(fe.jsx)(Z.a,{path:"/users",children:t&&Object(fe.jsx)(me,{})}),Object(fe.jsx)(Z.a,{path:"/blogs/:id",children:t&&Object(fe.jsx)(Te,{blog:f,likeBlog:l,removeBlog:d,loggedInUserId:t.id,addComment:function(t,n){try{e(function(e,t){return function(){var n=Object(m.a)(h.a.mark((function n(r){var c;return h.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,T.addComment(e,t);case 2:c=n.sent,r({type:"NEW_COMMENT",data:{id:e,comment:c}});case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()}(t,n))}catch(r){e(b("Commenting blog failed.","error"))}}})}),Object(fe.jsx)(Z.a,{path:"/",children:t&&Object(fe.jsx)(we,{})})]}),Object(fe.jsx)(re,{children:Object(fe.jsx)("em",{children:Object(fe.jsx)("small",{children:"Full Stack open 2021 blog list exercise by ajjmai"})})})]})};i.a.render(Object(fe.jsx)(o.a,{store:X,children:Object(fe.jsx)(s.a,{children:Object(fe.jsx)(Se,{})})}),document.getElementById("root"))}},[[74,1,2]]]);
//# sourceMappingURL=main.77034534.chunk.js.map